<div
  class="task-item"
  [class.completed]="task().status === taskStatus.DONE"
  [attr.data-priority]="task().priority"
>
  <div class="task-header">
    <div class="task-title">
      <h3>{{ task().title }}</h3>
      <div class="task-meta">
        <span class="task-id">#{{ task().id.substring(0, 8) }}</span>
        <span class="task-priority" [class]="'priority-' + task().priority">
          {{ getPriorityLabel(task().priority) }}
        </span>
      </div>
    </div>

    <div class="task-actions">
      <button class="btn-icon" (click)="onEdit()" type="button" aria-label="Edit task">✏️</button>
      <button class="btn-icon" (click)="onDelete()" type="button" aria-label="Delete task">
        🗑️
      </button>
    </div>
  </div>

  <div class="task-content">
    @if (task().description) {
      <p class="task-description">{{ task().description }}</p>
    }

    @if (task().tags.length > 0) {
      <div class="task-tags">
        @for (tag of task().tags; track tag) {
          <span class="tag">{{ tag }}</span>
        }
      </div>
    }
  </div>

  <div class="task-footer">
    <div class="task-assignee">
      @if (assignee(); as user) {
        <app-user-avatar [user]="user" size="small"> </app-user-avatar>
        <span class="assignee-name">{{ user.name }}</span>
      } @else {
        <span class="unassigned">Unassigned</span>
      }
    </div>

    <div class="task-status">
      <select
        [value]="task().status"
        (change)="onStatusChange($event)"
        class="status-select"
        [attr.aria-label]="'Change status for task: ' + task().title"
      >
        @for (status of statusOptions; track status.value) {
          <option [value]="status.value">{{ status.label }}</option>
        }
      </select>
    </div>

    @if (task().dueDate) {
      <div class="task-due-date" [class.overdue]="isOverdue()">
        📅 {{ formatDate(task().dueDate) }}
      </div>
    }
  </div>
</div>
